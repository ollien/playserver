document.addEventListener("DOMContentLoaded",function(e){function t(e){r.textContent=e.song,p.textContent=e.artist+" - "+e.album}function n(){var e=new XMLHttpRequest;e.open("GET","/get_song_info"),e.addEventListener("load",function(n){data=JSON.parse(e.responseText),t(data)}),e.send()}function a(e){var t=new XMLHttpRequest;t.open("POST","/"+e,!0),t.addEventListener("load",function(e){200===t.status&&n()}),t.send()}function o(){L?(l.classList.remove("fa-play"),l.classList.add("fa-pause")):(l.classList.remove("fa-pause"),l.classList.add("fa-play"))}function s(){var e=new XMLHttpRequest;e.open("GET","/get_player_state"),e.addEventListener("load",function(t){data=JSON.parse(e.responseText),L=data.playing,o()}),e.send()}function d(){var e=new XMLHttpRequest;e.open("GET","/get_applications"),e.addEventListener("load",function(t){data=JSON.parse(e.responseText),data.forEach(function(e){option=document.createElement("option"),option.textContent=e.name,option.setAttribute("value",e.key),v.appendChild(option),e.current&&(v.value=e.key)})}),e.send()}function i(){console.log("requesting");var e=new XMLHttpRequest;e.open("GET","/get_system_volume"),e.addEventListener("load",function(t){console.log("requested"),f.value=e.responseText}),e.send()}var c=document.getElementById("previous"),l=document.getElementById("playpause"),u=document.getElementById("next"),r=document.getElementById("track-line-1"),p=document.getElementById("track-line-2"),m=document.querySelectorAll("div.bubble"),v=document.getElementById("player-select"),f=document.getElementById("volume-slider"),L=!1,E=new WebSocket("ws://"+window.location.hostname+":5001");d(),n(),s(),i(),E.addEventListener("message",function(e){data=JSON.parse(e.data),L=data.playing,t(data),o()}),c.addEventListener("click",function(e){a("previous"),c.classList.add("animating")}),l.addEventListener("click",function(e){a("play_pause"),l.classList.add("animating"),s()}),u.addEventListener("click",function(e){a("next"),u.classList.add("animating")}),Array.prototype.slice.call(m).forEach(function(e){e.addEventListener("animationend",function(t){e.parentNode.classList.remove("animating")})}),v.addEventListener("change",function(e){var t=new XMLHttpRequest;t.open("POST","/set_application"),t.setRequestHeader("Content-Type","application/x-wwww-form-urlencoded; charset=UTF-8"),t.addEventListener("load",function(e){n(),s()}),t.send(JSON.stringify({application:v.value}))})});